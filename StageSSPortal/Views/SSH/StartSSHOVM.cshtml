@Styles.Render("~/Content/ShowVm.css")



<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        //$("button#test").click(function () {
        // alert("test");
        $("select").hide();
        $("table#LijstServerVMs").delegate("tr:not(:first)", "click", function () {
            $(".VmRow").css("color", "rgb(0, 0, 0)");
            $(this).css("color", "rgb(244, 78, 66)");
            showInfo();
        });
        showVmNames();

    });

    function checkForVms() {
        //if ($("#ShowVms").css("display") != "none") {
        //    $("table#LijstServerVMs").find("tr:not(:first)").remove();
        //    $("#VmInfo").css("display", "none");
        //}
        alert("check voor vms");
        $.ajax("/api/SSH/CheckVms", {
            type: "GET",
            dataType: "json"
        })
            .done(function (data) {
                //alert("data"+data);
                ShowVms(data);
            })
    }
    function loadKlanten() {
        $("select").show();
        $.ajax("/api/SSH/Klanten", {
            type: "GET",
            dataType: "json"
        })
            .done(function (data) {
                $("#klantenlijst").find("option").remove();
                $.each(data, function (index, value) {
                    $("#klantenlijst").append("<option class=klant> " + value.Naam + "</option>");
                })
            });
    }
    function showVmNames() {
        //alert("vmnames");
        if ($("#ShowVms").css("display") != "none") {
            $("table#LijstServerVMs").find("tr:not(:first)").remove();
            $("#VmInfo").css("display", "none");
        }
        $.ajax("/api/SSH/vmsDB", {
            type: "GET",
            dataType: "json"
        })
            .done(function (data) {
                //   alert("vmnamesdone")
                checkForVms();
                //ShowVms(data);
            })
    };
    function ShowVms(LijstServerVMs) {

        $.each(LijstServerVMs, function (index, value) {
            addVM(value);
        })
        $("#ShowVms").css("display", "block");
    }
    function changeColor() {
        $(this).css('background-color', 'rgb(58, 187, 252)');
    }
    function addVM(vm) {
        //alert(vm.id)
        $("table#LijstServerVMs").append("<tr  class=VmRow id=" + vm.id + ">" + "<td>" + vm.Name + "</td>" /*+ "<td>" + vm.Status + "</td>"*/ + "</tr>");
    }
    function showInfo() {
        $("select").hide();

        $("#ListVmInfo").find("tr").remove();
        $("#VmInfo").css("display", "none");
        var t;
        $("tr.VmRow").each(function () {
            if ($(this).css('color') == "rgb(244, 78, 66)") {
                //t = $(this).children("td:first").attr("id");
                t = $(this).attr('id');
                //t.replace(".", "-");
                //  alert(t);
            }
        })
        $.ajax("/api/SSH/info/" + t, { //+ $(this).val(), {
            type: "GET",
            dataType: "json"
        })
            .done(function (data) {
                loadKlanten();
                var text = data;
                //alert(text);
                //alert("test");
                $.each(data, function (index, value) {
                    $("table#ListVmInfo").append("<tr class=VmInfoRow> <td>" + value + "</td> </tr>");
                })
                $("#VmInfo").css("display", "block");
                $("table#ListVmInfo").find("tr:first").css("font-weight", "bold");
            })
    };


    function StopVM() {
        var t;
        $("tr.VmRow").each(function () {
            if ($(this).css('color') == "rgb(244, 78, 66)") {
                t = $(this).attr('id');
                alert(t);
            }
            $.ajax("/api/SSH/StopVM/" + t, {
                type: "GET",
                dataType: "json"
            })
                .done
                (function (data) {

                })
        }); showVmNames();

        //document.location.reload();

    };

    function SaveKlantVM() {
        var t;
        $("tr.VmRow").each(function () {
            if ($(this).css('color') == "rgb(244, 78, 66)") {
                t = $(this).attr('id');
                alert(t);
            }
            var k = $("#klantenlijst").val();
            //alert(k);
            //alert(t);
            $.ajax("/api/SSH/KlantOVM/" + t + '/' + k, {
                type: "GET",
                dataType: "json"
            })
                .done
                (function (data) {
                })
        });
        //document.location.reload();
        showVmNames();

    }

    function StartVM() {
        var t;
        $("tr.VmRow").each(function () {
            if ($(this).css('color') == "rgb(244, 78, 66)") {
                //t = $(this).children("td:first").attr("id");
                t = $(this).attr('id');
                //t.replace(".", "-");
                alert(t);
            }
            $.ajax("/api/SSH/StartVM/" + t, { //+ $(this).val(), {
                type: "GET",
                dataType: "json"
            })
                .done
                (function (data) {

                })
        });
        //document.location.reload();
        showVmNames();


    };
</script>

<div>
    <h1>Beheer Virtuele Machines</h1>
</div>


<div id="ShowVms" style="display:none">
    <table id="LijstServerVMs" class="table">
        <tr>
            <th>Name</th>
            @*<th>Status</th>*@

        </tr>
    </table>
</div>
<div id="ShowVms" style="display:none">
    <select id="LijstServerVms"></select>
</div>
<div id="VmInfo" style="display:none">
    <table id="ListVmInfo" class="table"></table>
</div>
<div id="btns">
    <button class=" btn btn-default" id="btn" onclick="StopVM()">Stop VM </button>
    <button class=" btn btn-default" id="btn" onclick="StartVM()">Start VM </button>
</div>
<select id="klantenlijst"></select>
<button class=" btn btn-default" id="btn" onclick="SaveKlantVM()">Save Klant</button>
@*@Scripts.Render("~/Scripts/Ssh/sshScripts.js")*@

@*<div class="select" tabindex="1">
        <input class="selectopt" name="test" type="radio" id="opt1" checked>
        <label for="opt1" class="option">Oranges</label>
        <input class="selectopt" name="test" type="radio" id="opt2">
        <label for="opt2" class="option">Apples</label>
        <input class="selectopt" name="test" type="radio" id="opt3">
        <label for="opt3" class="option">Grapefruit</label>
        <input class="selectopt" name="test" type="radio" id="opt4">
        <label for="opt4" class="option">Bananas</label>
        <input class="selectopt" name="test" type="radio" id="opt5">
        <label for="opt5" class="option">Watermelon</label>
    </div>*@